[
  {
    "doctype": "Report",
    "report_name": "Item-wise Journal Entries",
    "ref_doctype": "Journal Entry",
    "report_type": "Script Report",
    "is_standard": "No",
    "module": "Accounts",
    "query": "import frappe\n\ndef execute(filters=None):\n    columns = [\n        {\"fieldname\": \"posting_date\", \"label\": \"Date\", \"fieldtype\": \"Date\", \"width\": 100},\n        {\"fieldname\": \"journal_entry\", \"label\": \"Journal Entry\", \"fieldtype\": \"Link\", \"options\": \"Journal Entry\", \"width\": 140},\n        {\"fieldname\": \"item\", \"label\": \"Item\", \"fieldtype\": \"Link\", \"options\": \"Item\", \"width\": 150},\n        {\"fieldname\": \"account\", \"label\": \"Account\", \"fieldtype\": \"Link\", \"options\": \"Account\", \"width\": 180},\n        {\"fieldname\": \"party\", \"label\": \"Party\", \"fieldtype\": \"Data\", \"width\": 130},\n        {\"fieldname\": \"debit\", \"label\": \"Debit\", \"fieldtype\": \"Currency\", \"width\": 110},\n        {\"fieldname\": \"credit\", \"label\": \"Credit\", \"fieldtype\": \"Currency\", \"width\": 110},\n        {\"fieldname\": \"user_remark\", \"label\": \"Remarks\", \"fieldtype\": \"Data\", \"width\": 180},\n    ]\n    cond = \"je.docstatus = 1 AND jea.custom_item IS NOT NULL AND jea.custom_item != \"\n    if filters.get(\"item\"):\n        cond += \" AND jea.custom_item = %(item)s\"\n    if filters.get(\"from_date\"):\n        cond += \" AND je.posting_date >= %(from_date)s\"\n    if filters.get(\"to_date\"):\n        cond += \" AND je.posting_date <= %(to_date)s\"\n    if filters.get(\"company\"):\n        cond += \" AND je.company = %(company)s\"\n    data = frappe.db.sql(f\"\"\"\n        SELECT je.posting_date, je.name as journal_entry, jea.custom_item as item, jea.account,\n               CONCAT(IFNULL(jea.party_type,), IF(jea.party_type IS NOT NULL AND jea.party IS NOT NULL, : , ), IFNULL(jea.party,)) as party,\n               jea.debit_in_account_currency as debit, jea.credit_in_account_currency as credit, je.user_remark\n        FROM `tabJournal Entry` je\n        INNER JOIN `tabJournal Entry Account` jea ON jea.parent = je.name\n        WHERE {cond} ORDER BY je.posting_date, je.name\n    \"\"\", filters, as_dict=1)\n    return columns, data\n"
  },
  {
    "doctype": "Report",
    "report_name": "Item Ledger",
    "ref_doctype": "Journal Entry",
    "report_type": "Script Report",
    "is_standard": "No",
    "module": "Accounts",
    "query": "import frappe\n\ndef execute(filters=None):\n    if not filters.get(\"item\"):\n        frappe.throw(\"Please select an Item\")\n    \n    columns = [\n        {\"fieldname\": \"posting_date\", \"label\": \"Date\", \"fieldtype\": \"Date\", \"width\": 100},\n        {\"fieldname\": \"journal_entry\", \"label\": \"Voucher\", \"fieldtype\": \"Link\", \"options\": \"Journal Entry\", \"width\": 140},\n        {\"fieldname\": \"account\", \"label\": \"Account\", \"fieldtype\": \"Link\", \"options\": \"Account\", \"width\": 180},\n        {\"fieldname\": \"party\", \"label\": \"Party\", \"fieldtype\": \"Data\", \"width\": 130},\n        {\"fieldname\": \"debit\", \"label\": \"Debit\", \"fieldtype\": \"Currency\", \"width\": 110},\n        {\"fieldname\": \"credit\", \"label\": \"Credit\", \"fieldtype\": \"Currency\", \"width\": 110},\n        {\"fieldname\": \"balance\", \"label\": \"Balance\", \"fieldtype\": \"Currency\", \"width\": 120},\n        {\"fieldname\": \"user_remark\", \"label\": \"Remarks\", \"fieldtype\": \"Data\", \"width\": 150},\n    ]\n    \n    cond = \"je.docstatus = 1 AND jea.custom_item = %(item)s\"\n    if filters.get(\"from_date\"):\n        cond += \" AND je.posting_date >= %(from_date)s\"\n    if filters.get(\"to_date\"):\n        cond += \" AND je.posting_date <= %(to_date)s\"\n    if filters.get(\"company\"):\n        cond += \" AND je.company = %(company)s\"\n    \n    entries = frappe.db.sql(f\"\"\"\n        SELECT je.posting_date, je.name as journal_entry, jea.account,\n               CONCAT(IFNULL(jea.party_type,), IF(jea.party_type IS NOT NULL AND jea.party IS NOT NULL, : , ), IFNULL(jea.party,)) as party,\n               jea.debit_in_account_currency as debit, jea.credit_in_account_currency as credit, je.user_remark\n        FROM `tabJournal Entry` je\n        INNER JOIN `tabJournal Entry Account` jea ON jea.parent = je.name\n        WHERE {cond} ORDER BY je.posting_date, je.creation\n    \"\"\", filters, as_dict=1)\n    \n    balance = 0\n    for row in entries:\n        balance += (row.debit or 0) - (row.credit or 0)\n        row[\"balance\"] = balance\n    \n    return columns, entries\n"
  }
]